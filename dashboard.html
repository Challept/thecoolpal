<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <link rel="stylesheet" href="dashboard-style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* Styles for the alert message */
        .alert-message {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #f44336;
            color: white;
            padding: 15px 30px;
            border-radius: 5px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            display: none;
        }
    </style>
    <script>
        // Check login on page load
        window.onload = function() {
            firebase.auth().onAuthStateChanged((user) => {
                if (user) {
                    console.log("Användare inloggad:", user.email);
                } else {
                    sessionStorage.setItem('showLogoutAlert', 'true');
                    window.location.href = 'admin.html';
                }
            });
        };

        // Show alert if logged out
        window.addEventListener('load', function() {
            if (sessionStorage.getItem('showLogoutAlert') === 'true') {
                showAlertMessage('Du har blivit utloggad. Logga in igen.');
                sessionStorage.removeItem('showLogoutAlert');
            }
        });

        function showAlertMessage(message) {
            const alertBox = document.createElement('div');
            alertBox.classList.add('alert-message');
            alertBox.innerText = message;
            document.body.appendChild(alertBox);
            alertBox.style.display = 'block';

            setTimeout(() => {
                alertBox.style.display = 'none';
                document.body.removeChild(alertBox);
            }, 5000);
        }

        function logout() {
            firebase.auth().signOut().then(() => {
                sessionStorage.removeItem('loggedIn');
                sessionStorage.setItem('showLogoutAlert', 'true');
                window.location.href = 'admin.html';
            }).catch((error) => {
                console.error("Logout error:", error);
            });
        }

        function openProfilePopup() {
            document.getElementById('profile-popup').style.display = 'block';
        }

        function closeProfilePopup() {
            document.getElementById('profile-popup').style.display = 'none';
        }
    </script>
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar">
        <ul class="menu">
            <li class="menu-item" onclick="openPopup('#hem')">
                <i class="fas fa-home"></i><span class="menu-text">Hem</span>
            </li>
            <li class="menu-item" onclick="openPopup('#website')">
                <i class="fas fa-edit"></i><span class="menu-text">Hemsida</span>
            </li>
            <li class="menu-item" onclick="openPopup('#inställningar')">
                <i class="fas fa-cogs"></i><span class="menu-text">Inställningar</span>
            </li>
            <li class="menu-item" onclick="openPopup('#statistik')">
                <i class="fas fa-chart-line"></i><span class="menu-text">Statistik</span>
            </li>
            <li class="menu-item" onclick="openPopup('#användare')">
                <i class="fas fa-users"></i><span class="menu-text">Användare</span>
            </li>
            <li class="menu-item" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i><span class="menu-text">Logga ut</span>
            </li>
        </ul>
    </div>

    <!-- Main content -->
    <div class="main-content">
        <div class="header">
            <h1>Välkommen till din Dashboard</h1>
            <p>Här kan du se och hantera din hemsida</p>
        </div>

        <!-- Profile card at top-right corner -->
        <div class="profile-card" onclick="openProfilePopup()">
            <span>Butik: VF Parfym</span>
            <i class="fas fa-user-circle"></i>
        </div>

        <!-- Profile Popup -->
        <div id="profile-popup" class="profile-popup">
            <h3>Profilinställningar</h3>
            <label>Namn</label>
            <input type="text" placeholder="Ditt namn">
            <label>E-post</label>
            <input type="email" placeholder="Din e-post">
            <label>Telefonnummer</label>
            <input type="tel" placeholder="Ditt telefonnummer">
            <label>Butiksnamn</label>
            <input type="text" placeholder="Ditt butiksnamn" readonly>
            <button onclick="saveProfile()">Spara Ändringar</button>
            <button onclick="closeProfilePopup()">Stäng</button>
        </div>

        <!-- Live Preview Popup -->
        <div id="website-popup" class="website-popup">
            <button class="close-btn" onclick="closePopup('#website-popup')">Stäng Förhandsgranskning</button>
            <iframe src="https://kund5.webstay.se" width="100%" height="100%"></iframe>
        </div>
    </div>
</body>
</html>
