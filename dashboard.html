<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <link rel="stylesheet" href="dashboard-style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        .alert-message {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #f44336;
            color: white;
            padding: 15px 30px;
            border-radius: 5px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            display: none;
        }
        #live-preview-container {
            margin-top: 20px;
        }
        #editor {
            margin-top: 20px;
            padding: 20px;
            background-color: #f9f9f9;
            border-radius: 8px;
            width: 100%;
            max-width: 600px;
        }
        #editor label, #editor input, #editor textarea, #editor button {
            display: block;
            width: 100%;
            margin-top: 10px;
        }
        #editor button {
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        #editor button:hover {
            background-color: #45a049;
        }
    </style>
    <script>
        // Kontrollera inloggning vid sidladdning
        window.onload = function() {
            firebase.auth().onAuthStateChanged((user) => {
                if (user) {
                    console.log("Användare inloggad:", user.email);
                } else {
                    sessionStorage.setItem('showLogoutAlert', 'true');
                    window.location.href = 'admin.html';
                }
            });
        };

        // Visa alert om man blev utloggad
        window.addEventListener('load', function() {
            if (sessionStorage.getItem('showLogoutAlert') === 'true') {
                showAlertMessage('Du har blivit utloggad. Logga in igen.');
                sessionStorage.removeItem('showLogoutAlert');
            }
        });

        function showAlertMessage(message) {
            const alertBox = document.createElement('div');
            alertBox.classList.add('alert-message');
            alertBox.innerText = message;
            document.body.appendChild(alertBox);
            alertBox.style.display = 'block';

            setTimeout(() => {
                alertBox.style.display = 'none';
                document.body.removeChild(alertBox);
            }, 5000);
        }

        function logout() {
            firebase.auth().signOut().then(() => {
                sessionStorage.removeItem('loggedIn');
                sessionStorage.setItem('showLogoutAlert', 'true');
                window.location.href = 'admin.html';
            }).catch((error) => {
                console.error("Logout error:", error);
            });
        }

        // Innehåll för redigeringsfunktionen
        const initialContent = {
            heading: "Välkommen till Min Butik",
            content: "Detta är innehållet på din hemsida. Redigera texten här."
        };

        function updateLivePreview() {
            const iframe = document.getElementById('live-preview').contentWindow.document;
            iframe.querySelector('#heading').textContent = document.getElementById('edit-heading').value;
            iframe.querySelector('#content').textContent = document.getElementById('edit-content').value;
        }

        function saveChanges() {
            initialContent.heading = document.getElementById('edit-heading').value;
            initialContent.content = document.getElementById('edit-content').value;
            alert("Ändringar sparade!");
            updateLivePreview();
        }

        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('edit-heading').value = initialContent.heading;
            document.getElementById('edit-content').value = initialContent.content;

            document.getElementById('edit-heading').addEventListener('input', updateLivePreview);
            document.getElementById('edit-content').addEventListener('input', updateLivePreview);
        });
    </script>
</head>
<body>
    <div class="sidebar">
        <ul class="menu">
            <li class="menu-item" onclick="openPopup('#hem')">
                <i class="fas fa-home"></i><span class="menu-text">Hem</span>
            </li>
            <li class="menu-item" onclick="openPopup('#hemsida')">
                <i class="fas fa-edit"></i><span class="menu-text">Hemsida</span>
            </li>
            <li class="menu-item" onclick="openPopup('#inställningar')">
                <i class="fas fa-cogs"></i><span class="menu-text">Inställningar</span>
            </li>
            <li class="menu-item" onclick="openPopup('#statistik')">
                <i class="fas fa-chart-line"></i><span class="menu-text">Statistik</span>
            </li>
            <li class="menu-item" onclick="openPopup('#användare')">
                <i class="fas fa-users"></i><span class="menu-text">Användare</span>
            </li>
            <li class="menu-item" onclick="openPopup('#hjälp')">
                <i class="fas fa-question-circle"></i><span class="menu-text">Hjälp</span>
            </li>
            <li class="menu-item" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i><span class="menu-text">Logga ut</span>
            </li>
        </ul>
    </div>
    <div class="main-content">
        <h1>Välkommen till din Dashboard</h1>
        <p>Här kan du se och hantera din hemsida</p>

        <div id="live-preview-container">
            <h2>Förhandsgranskning</h2>
            <iframe id="live-preview" src="https://kund5.webstay.se" width="100%" height="500px"></iframe>
        </div>

        <div id="editor">
            <h2>Redigera Hemsida</h2>
            <label for="edit-heading">Redigera Rubrik</label>
            <input type="text" id="edit-heading" placeholder="Redigera rubriktext">
            <label for="edit-content">Redigera Innehåll</label>
            <textarea id="edit-content" placeholder="Redigera huvudinnehåll"></textarea>
            <button onclick="saveChanges()">Spara Ändringar</button>
        </div>
    </div>
</body>
</html>
